<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sarv Store</title>
    <link href="https://sarvwigyan.github.io/resources/Sarvstore.png" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="https://sarvwigyan.github.io/resources/Sarvstore.png">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --background: #0a0a0a;
            --card-bg: #2c2c2c;
            --text: #e0e0e0;
            --secondary-text: #bdc1c6;
            --primary: #1a73e8;
            --highlight: #00ffcc;
            --shadow: rgba(0, 0, 0, 0.2);
            --spacing-unit: 1rem;
            --transition-speed: 0.3s;
        }

        [data-theme="light"] {
            --background: #f0f0f0;
            --card-bg: #ffffff;
            --text: #333333;
            --secondary-text: #666666;
            --primary: #1a73e8;
            --highlight: #00cc99;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
        }

        body::-webkit-scrollbar {
            width: 8px;
        }

        body::-webkit-scrollbar-thumb {
            background-color: var(--primary);
            border-radius: 4px;
        }

        body::-webkit-scrollbar-track {
            background-color: var(--card-bg);
        }

        .header {
            padding: calc(var(--spacing-unit) * 1.5) calc(var(--spacing-unit) * 2);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--card-bg);
            box-shadow: 0 4px 10px var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            flex-wrap: nowrap;
            gap: var(--spacing-unit);
        }

        .header-logo {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-shrink: 0;
        }

        .search-bar {
            flex: 1;
            max-width: 50%;
            position: relative;
            min-width: 150px;
        }

        .search-bar input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--primary);
            border-radius: 24px;
            background-color: var(--background);
            color: var(--text);
            font-size: 1rem;
            outline: none;
            transition: all var(--transition-speed) ease;
        }

        .search-bar input:focus {
            border-color: var(--highlight);
            box-shadow: 0 0 5px var(--highlight);
        }

        .settings-icon {
            font-size: 1.75rem;
            color: var(--primary);
            cursor: pointer;
            transition: transform var(--transition-speed) ease;
            flex-shrink: 0;
        }

        .settings-icon:hover {
            transform: rotate(90deg);
        }

        .tabs {
            background-color: var(--card-bg);
            padding: calc(var(--spacing-unit) * 0.75) calc(var(--spacing-unit) * 1.5);
            border-bottom: 1px solid var(--shadow);
            overflow-x: auto;
            white-space: nowrap;
        }

        .tab-list {
            display: inline-flex;
            gap: calc(var(--spacing-unit) * 2);
            align-items: center;
        }

        .tab {
            padding: 0.75rem 1rem;
            font-size: 1rem;
            font-weight: 500;
            color: var(--secondary-text);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            position: relative;
            border-radius: 8px;
        }

        .tab.active {
            color: var(--highlight);
            background-color: var(--background);
        }

        .tab.hidden {
            display: none;
        }

        .content {
            padding: calc(var(--spacing-unit) * 2);
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        .section {
            display: none;
            opacity: 0;
            transition: opacity var(--transition-speed) ease;
        }

        .section.active {
            display: block;
            opacity: 1;
        }

        .section-title {
            font-size: 1.75rem;
            font-weight: 500;
            margin-bottom: calc(var(--spacing-unit) * 1.5);
            color: var(--text);
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: calc(var(--spacing-unit) * 1.5);
            width: 100%;
        }

        .featured-section {
            display: none;
        }

        .section#all.active ~ .featured-section {
            display: block;
        }

        .featured-section .card-grid {
            display: flex;
            overflow-x: auto;
            white-space: nowrap;
            gap: calc(var(--spacing-unit) * 1.5);
            padding-bottom: var(--spacing-unit);
        }

        .featured-section .card-grid::-webkit-scrollbar {
            height: 8px;
        }

        .featured-section .card-grid::-webkit-scrollbar-thumb {
            background-color: var(--primary);
            border-radius: 4px;
        }

        .featured-section .card-grid::-webkit-scrollbar-track {
            background-color: var(--card-bg);
        }

        .featured-section .card {
            flex: 0 0 auto;
            width: 200px;
            min-width: 200px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: calc(var(--spacing-unit) * 1.5);
            text-align: center;
            box-shadow: 0 4px 12px var(--shadow);
            transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
            cursor: pointer;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 8px 20px var(--shadow);
        }

        .card-logo {
            width: 5rem;
            height: 5rem;
            border-radius: 20px;
            object-fit: cover;
            margin: 0 auto calc(var(--spacing-unit) * 1);
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: normal;
            overflow-wrap: break-word;
            max-height: 3.75rem;
        }

        .card-type {
            font-size: 0.875rem;
            color: var(--secondary-text);
            margin-bottom: calc(var(--spacing-unit) * 1);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .card-download {
            padding: 0.625rem 1.5rem;
            background: linear-gradient(135deg, var(--primary), var(--highlight));
            color: #fff;
            border: none;
            border-radius: 24px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: transform var(--transition-speed) ease;
            margin-top: auto;
        }

        .card-download:hover {
            transform: scale(1.05);
        }

        .no-results {
            text-align: center;
            color: var(--secondary-text);
            font-size: 1rem;
            margin-top: calc(var(--spacing-unit) * 2);
            display: none;
        }

        .detail-view {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90vw;
            max-width: 800px;
            max-height: 85vh;
            overflow-y: auto;
            background: var(--background);
            padding: calc(var(--spacing-unit) * 2);
            border-radius: 16px;
            box-shadow: 0 8px 24px var(--shadow);
            opacity: 0;
            transition: opacity var(--transition-speed) ease, transform var(--transition-speed) ease;
            display: none;
            z-index: 1001;
        }

        .detail-view.active {
            display: block;
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        .close-btn {
            position: absolute;
            top: var(--spacing-unit);
            right: var(--spacing-unit);
            background: var(--primary);
            color: #fff;
            border: none;
            font-size: 1.5rem;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background var(--transition-speed) ease;
        }

        .close-btn:hover {
            background: var(--highlight);
        }

        .detail-header {
            display: flex;
            gap: calc(var(--spacing-unit) * 2);
            align-items: flex-start;
            margin-bottom: calc(var(--spacing-unit) * 2);
            flex-wrap: wrap;
        }

        .detail-logo {
            width: 6rem;
            height: 6rem;
            border-radius: 24px;
            object-fit: cover;
            box-shadow: 0 4px 12px var(--shadow);
            flex-shrink: 0;
        }

        .detail-info {
            flex: 1;
            min-width: 200px;
        }

        .detail-title {
            font-size: 2rem;
            font-weight: 600;
            color: var(--text);
        }

        .detail-type {
            font-size: 1rem;
            color: var(--secondary-text);
            margin-bottom: 0.5rem;
        }

        .detail-verified {
            font-size: 1rem;
            color: var(--highlight);
            margin-bottom: calc(var(--spacing-unit) * 1.5);
        }

        .detail-download {
            padding: 0.75rem 2rem;
            background: linear-gradient(45deg, var(--primary), var(--highlight));
            color: #fff;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: transform var(--transition-speed) ease;
        }

        .detail-download:hover {
            transform: scale(1.05);
        }

        .detail-short-desc {
            font-size: 1.125rem;
            color: var(--text);
            margin-bottom: calc(var(--spacing-unit) * 1.5);
        }

        .detail-long-desc {
            font-size: 1rem;
            color: var(--secondary-text);
            line-height: 1.8;
        }

        .detail-images {
            display: flex;
            gap: calc(var(--spacing-unit) * 1.5);
            overflow-x: auto;
            padding: calc(var(--spacing-unit) * 1.5) 0;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 12px var(--shadow);
            flex-wrap: nowrap;
        }

        .detail-images img {
            width: 250px;
            height: 150px;
            border-radius: 12px;
            object-fit: cover;
            transition: transform var(--transition-speed) ease;
            flex-shrink: 0;
        }

        .detail-images img:hover {
            transform: scale(1.05);
        }

        .settings-window {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--card-bg);
            padding: calc(var(--spacing-unit) * 2);
            border-radius: 12px;
            box-shadow: 0 8px 16px var(--shadow);
            z-index: 1002;
            width: 90vw;
            max-width: 450px;
            opacity: 0;
            transition: opacity var(--transition-speed) ease, transform var(--transition-speed) ease;
            display: none;
        }

        .settings-window.active {
            display: block;
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        .settings-window h2 {
            font-size: 1.75rem;
            font-weight: 500;
            margin-bottom: calc(var(--spacing-unit) * 1.5);
            color: var(--text);
        }

        .settings-option {
            margin-bottom: calc(var(--spacing-unit) * 1.5);
        }

        .settings-window label {
            display: block;
            font-size: 1rem;
            color: var(--secondary-text);
            margin-bottom: 0.5rem;
        }

        .settings-window select,
        .settings-window input[type="checkbox"] {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--primary);
            border-radius: 8px;
            font-size: 1rem;
            background: var(--background);
            color: var(--text);
            outline: none;
        }

        .settings-window input[type="checkbox"] {
            width: auto;
            margin-right: 0.5rem;
        }

        .settings-window button {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(45deg, var(--primary), var(--highlight));
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: transform var(--transition-speed) ease;
            width: 100%;
        }

        .settings-window button:hover {
            transform: scale(1.05);
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            opacity: 0;
            transition: opacity var(--transition-speed) ease;
            display: none;
        }

        .overlay.active {
            display: block;
            opacity: 1;
        }

        footer {
            background: var(--card-bg);
            padding: var(--spacing-unit);
            text-align: center;
            color: var(--secondary-text);
            font-size: 0.875rem;
            margin-top: calc(var(--spacing-unit) * 2);
        }

        footer nav {
            margin-top: 0.5rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        footer a {
            color: var(--primary);
            text-decoration: none;
            transition: color var(--transition-speed) ease;
        }

        footer a:hover {
            color: var(--highlight);
        }

        .filter-section {
            margin-bottom: calc(var(--spacing-unit) * 1.5);
        }

        .filter-section select {
            padding: 0.75rem;
            border: 1px solid var(--primary);
            border-radius: 8px;
            font-size: 1rem;
            background: var(--background);
            color: var(--text);
            outline: none;
            margin-right: 0.5rem;
        }

        @keyframes rainbowGlow {
            0% { box-shadow: 0 0 10px #ff0000; }
            20% { box-shadow: 0 0 10px #ff00ff; }
            40% { box-shadow: 0 0 40px #0000ff; }
            60% { box-shadow: 0 0 60px #00ffff; }
            80% { box-shadow: 0 0 80px #00ff00; }
            100% { box-shadow: 0 0 100px #ff0000; }
        }

        .rainbow-active {
            animation: rainbowGlow 3s infinite;
        }

        @media (max-width: 1400px) {
            .content {
                max-width: 1200px;
            }
            .card-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }
            .featured-section .card {
                width: 180px;
                min-width: 180px;
            }
        }

        @media (max-width: 1200px) {
            .search-bar {
                max-width: 40%;
            }
            .card-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            }
            .featured-section .card {
                width: 160px;
                min-width: 160px;
            }
            .detail-logo {
                width: 7rem;
                height: 7rem;
            }
        }

        @media (max-width: 900px) {
            .header {
                padding: var(--spacing-unit);
            }
            .header-logo {
                height: 1.75rem;
                font-size: 1.5rem;
            }
            .search-bar {
                max-width: 50%;
                min-width: 120px;
            }
            .card-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            .featured-section .card {
                width: 150px;
                min-width: 150px;
            }
            .detail-header {
                gap: var(--spacing-unit);
            }
            .detail-logo {
                width: 6rem;
                height: 6rem;
            }
            .tab-list {
                gap: var(--spacing-unit);
            }
        }

        @media (max-width: 600px) {
            .header {
                padding: calc(var(--spacing-unit) * 0.75);
                flex-direction: row;
                flex-wrap: nowrap;
                align-items: center;
                justify-content: space-between;
            }
            .header-logo {
                font-size: 1.25rem;
                flex-shrink: 1;
                max-width: 30%;
            }
            .header-logo img {
                height: 1.25rem;
            }
            .search-bar {
                max-width: 50%;
                min-width: 100px;
                flex-grow: 1;
            }
            .search-bar input {
                padding: 0.5rem;
                font-size: 0.875rem;
            }
            .settings-icon {
                font-size: 1.25rem;
                flex-shrink: 0;
            }
            .tabs {
                padding: 0.5rem;
            }
            .tab {
                font-size: 0.875rem;
                padding: 0.5rem;
            }
            .content {
                padding: var(--spacing-unit);
            }
            .card-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--spacing-unit);
            }
            .featured-section .card {
                width: 140px;
                min-width: 140px;
            }
            .card {
                padding: var(--spacing-unit);
            }
            .card-logo {
                width: 3.5rem;
                height: 3.5rem;
            }
            .detail-view {
                padding: var(--spacing-unit);
                max-width: 95vw;
                width: 95vw;
            }
            .detail-header {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            .detail-logo {
                width: 5rem;
                height: 5rem;
            }
            .detail-images {
                flex-direction: column;
                align-items: center;
            }
            .detail-images img {
                width: 100%;
                height: auto;
                max-width: 200px;
            }
            .section-title {
                font-size: 1.5rem;
            }
            .card-title {
                font-size: 1rem;
                max-height: 3rem;
            }
            .detail-title {
                font-size: 1.25rem;
            }
        }

        @media (max-width: 400px) {
            .header-logo {
                font-size: 1rem;
                max-width: 25%;
            }
            .header-logo img {
                height: 1rem;
            }
            .search-bar {
                max-width: 60%;
                min-width: 80px;
            }
            .settings-icon {
                font-size: 1rem;
            }
            .card-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .featured-section .card {
                width: 120px;
                min-width: 120px;
            }
            .card {
                padding: calc(var(--spacing-unit) * 0.75);
            }
            .card-logo {
                width: 3rem;
                height: 3rem;
            }
            .tab {
                font-size: 0.75rem;
                padding: 0.4rem 0.6rem;
            }
            .detail-logo {
                width: 4rem;
                height: 4rem;
            }
            .settings-window {
                max-width: 90vw;
            }
        }

        @media (max-width: 320px) {
            .header {
                padding: 0.5rem;
            }
            .search-bar input {
                padding: 0.4rem;
                font-size: 0.75rem;
            }
            .card-title {
                font-size: 0.875rem;
                max-height: 2.625rem;
            }
            .card-type {
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-logo">
            <img src="https://sarvwigyan.github.io/resources/Sarvstore.png" style="width: auto; height: 1.5em;"> Sarv Store
        </div>
        <div class="search-bar">
            <input type="text" placeholder="Search apps..." id="searchInput" aria-label="Search apps">
        </div>
        <div class="settings-icon" id="settingsIcon" role="button" aria-label="Open settings">⚙️</div>
    </div>

    <div class="tabs" role="tablist">
        <div class="tab-list">
            <div class="tab active" data-tab="all" role="tab" aria-selected="true" tabindex="0">All</div>
            <div class="tab" data-tab="books" role="tab" aria-selected="false" tabindex="0">Books</div>
            <div class="tab" data-tab="chelp" role="tab" aria-selected="false" tabindex="0">CodeX</div>
            <div class="tab" data-tab="games" role="tab" aria-selected="false" tabindex="0">Games</div>
            <div class="tab" data-tab="productivity" role="tab" aria-selected="false" tabindex="0">Productivity</div>
            <div class="tab" data-tab="recent" role="tab" aria-selected="false" tabindex="0">Recently Viewed</div>
            <div class="tab hidden" data-tab="favorites" role="tab" aria-selected="false" tabindex="0">Favorites</div>
        </div>
    </div>

    <div class="content">
        <div class="featured-section">
            <h2 class="section-title">Featured Apps</h2>
            <div class="filter-section">
                <select onchange="filterApps('featuredGrid', this.value)" aria-label="Filter featured apps">
                    <option value="">Filter by...</option>
                    <option value="popularity">Popularity</option>
                    <option value="rating">Rating</option>
                    <option value="newest">Newest</option>
                </select>
            </div>
            <div class="card-grid" id="featuredGrid"></div>
        </div>
        <div class="section active" id="all" role="tabpanel" aria-labelledby="all-tab">
            <h2 class="section-title">All Apps</h2>
            <div class="filter-section">
                <select onchange="filterApps('allGrid', this.value)" aria-label="Filter all apps">
                    <option value="">Filter by...</option>
                    <option value="popularity">Popularity</option>
                    <option value="rating">Rating</option>
                    <option value="newest">Newest</option>
                </select>
            </div>
            <div class="card-grid" id="allGrid"></div>
            <div class="no-results" id="allNoResults">No results found</div>
        </div>
        <div class="section" id="books" role="tabpanel" aria-labelledby="books-tab">
            <h2 class="section-title">Books</h2>
            <div class="filter-section">
                <select onchange="filterApps('booksGrid', this.value)" aria-label="Filter books">
                    <option value="">Filter by...</option>
                    <option value="language">Language</option>
                    <option value="genre">Genre</option>
                    <option value="author">Author</option>
                </select>
                <select id="language-filter" style="display: none;" onchange="filterByLanguage(this.value)" aria-label="Filter books by language">
                    <option value="">Select Language...</option>
                    <option value="english">English</option>
                    <option value="hindi">Hindi</option>
                    <option value="sanskrit">Sanskrit</option>
                </select>
            </div>
            <div class="card-grid" id="booksGrid"></div>
            <div class="no-results" id="booksNoResults">No results found</div>
        </div>
        <div class="section" id="chelp" role="tabpanel" aria-labelledby="chelp-tab">
            <h2 class="section-title">CodeX</h2>
            <div class="filter-section">
                <select onchange="filterApps('chelpGrid', this.value)" aria-label="Filter CodeX tools">
                    <option value="">Filter by...</option>
                    <option value="language">Programming Language</option>
                    <option value="difficulty">Difficulty</option>
                    <option value="category">Category</option>
                </select>
            </div>
            <div class="card-grid" id="chelpGrid"></div>
            <div class="no-results" id="chelpNoResults">No results found</div>
        </div>
        <div class="section" id="games" role="tabpanel" aria-labelledby="games-tab">
            <h2 class="section-title">Games</h2>
            <div class="filter-section">
                <select onchange="filterApps('gamesGrid', this.value)" aria-label="Filter games">
                    <option value="">Filter by...</option>
                    <option value="genre">Genre</option>
                    <option value="platform">Platform</option>
                    <option value="multiplayer">Multiplayer</option>
                </select>
            </div>
            <div class="card-grid" id="gamesGrid"></div>
            <div class="no-results" id="gamesNoResults">No results found</div>
        </div>
        <div class="section" id="productivity" role="tabpanel" aria-labelledby="productivity-tab">
            <h2 class="section-title">Productivity</h2>
            <div class="filter-section">
                <select onchange="filterApps('productivityGrid', this.value)" aria-label="Filter productivity apps">
                    <option value="">Filter by...</option>
                    <option value="category">Category</option>
                    <option value="price">Price</option>
                    <option value="rating">Rating</option>
                </select>
            </div>
            <div class="card-grid" id="productivityGrid"></div>
            <div class="no-results" id="productivityNoResults">No results found</div>
        </div>
        <div class="section" id="recent" role="tabpanel" aria-labelledby="recent-tab">
            <h2 class="section-title">Recently Viewed</h2>
            <div class="filter-section">
                <select onchange="filterApps('recentGrid', this.value)" aria-label="Filter recently viewed items">
                    <option value="">Filter by...</option>
                    <option value="date">Date Viewed</option>
                    <option value="category">Category</option>
                </select>
            </div>
            <div class="card-grid" id="recentGrid"></div>
            <div class="no-results" id="recentNoResults">No recently viewed items</div>
        </div>
        <div class="section" id="favorites" role="tabpanel" aria-labelledby="favorites-tab">
            <h2 class="section-title">Favorites</h2>
            <div class="filter-section">
                <select onchange="filterApps('favoritesGrid', this.value)" aria-label="Filter favorite items">
                    <option value="">Filter by...</option>
                    <option value="category">Category</option>
                    <option value="date-added">Date Added</option>
                </select>
            </div>
            <div class="card-grid" id="favoritesGrid"></div>
            <div class="no-results" id="favoritesNoResults">No favorite items yet</div>
        </div>
    </div>

    <div class="detail-view" id="detailView" role="dialog" aria-modal="true">
        <button class="close-btn" id="closeBtn" aria-label="Close details">×</button>
        <div class="detail-container">
            <div class="detail-header">
                <img class="detail-logo" id="detailLogo" src="" alt="App logo">
                <div class="detail-info">
                    <div class="detail-title" id="detailTitle"></div>
                    <div class="detail-type" id="detailType"></div>
                    <div class="detail-verified" id="detailVerified"></div>
                    <button class="detail-download" id="detailDownload">Download</button>
                </div>
            </div>
            <div class="detail-description">
                <div class="detail-short-desc" id="detailShortDesc"></div>
                <div class="detail-long-desc" id="detailLongDesc"></div>
                <div class="detail-images" id="detailImages"></div>
            </div>
        </div>
    </div>

    <div class="overlay" id="overlay"></div>
    <div class="settings-window" id="settingsWindow" role="dialog" aria-modal="true">
        <h2>Settings</h2>
        <div class="settings-option">
            <label for="theme">Theme</label>
            <select id="theme" aria-label="Select theme">
                <option value="dark">Dark</option>
                <option value="light">Light</option>
            </select>
        </div>
        <div class="settings-option">
            <label for="enableFavorites">Enable Favorites Tab</label>
            <input type="checkbox" id="enableFavorites" aria-label="Enable Favorites tab">
        </div>
        <button id="saveSettings">Save</button>
    </div>

    <footer>
        <p>© 2023 Sarv Store. All rights reserved.</p>
        <nav>
            <a href="#">About</a>
            <a href="#">Contact</a>
            <a href="#">Privacy Policy</a>
            <a href="#">Terms of Service</a>
            <a href="#">Help</a>
        </nav>
    </footer>

    <script>
        const storeData = {
            books: [
                { id:1, title:"The Art Of Being Perfect(Sanskrit)", type:"Books", verified:false, logo:"https://via.placeholder.com/64", shortDesc:"एषा पुस्तिका आत्मविकासस्य, चारित्रशुद्धेः, चित्तनिग्रहस्य च मार्गं प्रकाशयति। श्रद्धा, भक्तिः, तर्कः, भावना च — एतेषां समन्वयेन मानवस्य जीवने पूर्णत्वं साध्यते।", longDesc:"‘पूर्णत्वकला’ नाम पुस्तकायाः विशेषता या अस्ति यत् सा केवलं बाह्यजीवनस्य नियमपरायणतां न उपदिशति, अपि तु अंतरङ्गस्य आध्यात्मिकविकासं प्रति मानवं प्रेरयति। एषा पुस्तिका श्रद्धाया, भक्तेः, तर्कस्य, भावनायाः च समुच्चयेन आत्मशुद्धिं, चित्तस्थैर्यं, जीवनस्य उद्देशपरिज्ञानं च बोधयति। अत्र न केवलं तत्त्वविमर्शः दृश्यते, अपि तु प्रत्येकः पाठकः 'सत्यं किम्?' इति प्रश्नं स्वयमेव गवेषते। पूर्णत्वं न तु दशांशवर्जितरूपं, किं तु चरमं मानवीयतत्त्वम् — यत्र आत्मा स्वस्वरूपे विशुद्धे बोधयति। एषा पुस्तिका न केवलं ज्ञानसमृद्धा, अपि तु अनुभवपूरिता अस्ति, यत्र प्रत्येकः अध्यायः एकस्य साधकस्य चित्तगह्वरात् उत्पन्न इव दृश्यते। श्रद्धा आरम्भबिन्दुः, तर्कः निर्देशनम्, भावना प्रेरणा, भक्तिः प्रकाशः च इत्येते समवायेन आत्मविकासस्य पथं निर्मायन्ते। अतः 'पूर्णत्वकला' इत्ययं ग्रन्थः केवलं पाठ्यपुस्तकम् न, अपि तु जीवनदर्शकम्, आत्मदर्पणं च अस्ति, यत्र पाठकः आत्मनः स्वरूपं दृष्ट्वा विवर्धते।", images: ["https://via.placeholder.com/200x120"], file:"Books/TheArtOfBeingPerfectSanskrit.html", language: "Sanskrit" },
                { id: 2, title: "The Art Of Being Perfect(Hindi)", type: "Books", verified: false, logo: "https://via.placeholder.com/64", shortDesc: "यह पुस्तक आत्मविकास, विचारशीलता और जीवन की पूर्णता को प्राप्त करने की आध्यात्मिक दिशा दिखाती है।", longDesc: "'पूर्णता की कला' एक प्रेरणादायक और आत्मगामी पुस्तक है जो व्यक्ति को अपने आंतरिक स्वरूप की खोज, आत्मशुद्धि और आध्यात्मिक उन्नयन की ओर मार्गदर्शन करती है। इसमें श्रद्धा, तर्क, भावना और भक्ति जैसे गहरे तत्वों के माध्यम से जीवन की सार्थकता, उद्देश्य और आत्मिक पूर्णता की ओर बढ़ने का पथ दिखाया गया है। यह पुस्तक न केवल दार्शनिक विचार प्रस्तुत करती है, बल्कि पाठक को स्वयं से जुड़ने, अपनी चेतना को जाग्रत करने और एक संतुलित, शुद्ध तथा अर्थपूर्ण जीवन जीने के लिए प्रेरित करती है।", images: ["https://via.placeholder.com/200x120"], file: "Books/TheArtOfBeingPerfectHindi.html", language: "Hindi" },
                { id: 9, title: "श्रीमद्भगवद्गीता", type: "Books", verified: true, logo: "https://sarvwigyan.github.io/resources/bhagwadgeeta.png", shortDesc: "श्रीमद्भगवद्गीता एक दिव्य ग्रंथ है जो कर्म, ज्ञान और भक्ति के माध्यम से जीवन के धर्म, उद्देश्य और मोक्ष की दिशा प्रदान करता है।", longDesc: "श्रीमद्भगवद्गीता सनातन धर्म का सर्वश्रेष्ठ आध्यात्मिक ग्रंथ है, जो केवल एक युद्धभूमि पर दिए गए उपदेशों का संकलन नहीं, अपितु सम्पूर्ण मानवता के लिए जीवन, धर्म, कर्म, ज्ञान, भक्ति, योग, वैराग्य और मोक्ष का एक सार्वभौमिक मार्गदर्शन है; यह महाभारत के भीष्म पर्व का एक अंश होते हुए भी एक स्वतंत्र दार्शनिक ग्रंथ के रूप में प्रतिष्ठित है, जिसमें भगवान श्रीकृष्ण द्वारा अर्जुन को दिए गए उपदेश न केवल व्यक्तिगत संकट और कर्तव्य की उलझनों को सुलझाते हैं, बल्कि आत्मा की अमरता, शरीर की क्षणभंगुरता, निष्काम कर्म की महिमा, समत्व योग, भक्तियोग, ज्ञानयोग, सांख्ययोग, राजविद्या, और पुरुषोत्तम तत्व जैसे गूढ़ और दिव्य विषयों का अत्यंत सुन्दर तथा गूढ़ वर्णन करते हैं; इसमें मानव जीवन की प्रत्येक स्थिति में स्थिरबुद्धि, विवेक, धैर्य, और आध्यात्मिक जागरूकता के साथ कैसे जीया जाए, यह दर्शाया गया है, और यही कारण है कि यह ग्रंथ न केवल भारतवर्ष में, अपितु सम्पूर्ण विश्व में योगियों, दार्शनिकों, वैज्ञानिकों और सामान्य जनों के लिए भी आत्मबोध, शांति और सच्चे जीवन पथ की प्रेरणा बन चुका है; गीता का प्रत्येक श्लोक एक दर्पण है, जो आत्मा को उसके स्वरूप का बोध कराता है, और जीवन को एक युद्ध न मानकर एक साधना, एक सेवा और एक परम लक्ष्य की ओर उन्मुख यात्रा के रूप में देखने की दृष्टि प्रदान करता है।",
                 images: ["https://sarvwigyan.github.io/resources/bhagwadgeeta.png","https://sarvwigyan.github.io/resources/mahabharat1.jpg","https://sarvwigyan.github.io/resources/mahabharat2.jpg","https://sarvwigyan.github.io/resources/mahabharat3.jpg"], file: "Books/Bhagwadgeeta.html", language: "Hindi" },
                { id: 10, title: "स्कन्द पुराण", type: "Books", verified: true, logo: "https://sarvwigyan.github.io/resources/skandpuran.jpg", shortDesc: "'स्कन्द पुराण' हिन्दू धर्म के 18 महापुराणों में सबसे विशाल पुराण है, जो भगवान शिव और उनके पुत्र स्कन्द (कार्तिकेय) के महात्म्य एवं लीलाओं का विस्तार से वर्णन करता है।", longDesc: "स्कन्द पुराण हिन्दू धर्म के अठारह महापुराणों में सबसे विशाल और व्यापक ग्रंथ है, जिसमें लगभग 81,000 से अधिक श्लोक हैं और यह भगवान शिव के पुत्र भगवान स्कन्द (कार्तिकेय) की शिक्षाओं, लीलाओं और महात्म्य को केन्द्र में रखता है, परन्तु इसकी विषयवस्तु केवल स्कन्द तक सीमित नहीं है; इसमें शिव-पार्वती की कथाएँ, तीर्थों का महत्व, व्रतों और पर्वों की महिमा, धार्मिक आचार, योग, वेदांत, भक्ति, मोक्ष और जीवन के चार पुरुषार्थों – धर्म, अर्थ, काम, मोक्ष – का गहन विवेचन है, साथ ही भारत के पवित्र तीर्थ स्थलों जैसे काशी, प्रयाग, केदार, बद्रीनाथ, सोमनाथ, कुरुक्षेत्र आदि की महत्ता और कथा विस्तार से वर्णित है, विशेष रूप से इसका काशी खंड अत्यंत प्रसिद्ध है जो काशी नगरी की आध्यात्मिक और सांस्कृतिक गरिमा को अमर करता है, यह पुराण न केवल शिव भक्तों के लिए एक अनमोल ग्रंथ है बल्कि हिन्दू धर्म के सांस्कृतिक, भौगोलिक, और आध्यात्मिक दर्शन का जीवंत दस्तावेज़ भी है जो श्रद्धा, कर्म और ज्ञान के अद्भुत समन्वय को प्रस्तुत करता है।",
                 images: ["https://sarvwigyan.github.io/resources/skandpuran.jpg"], file: "Books/Skandpuranhindi.html", language: "Hindi" },
                {id: 11,title: "भविष्य पुराण",type: "Books",verified: true,logo: "https://sarvwigyan.github.io/resources/BhavishyaPuran.png",shortDesc: "'भविष्य पुराण' हिन्दू पुराणों में एक विशिष्ट ग्रंथ है जो भविष्यवाणियों, धर्म, और सांस्कृतिक परंपराओं का संगम है।",longDesc: "भविष्य पुराण हिन्दू धर्म का एक प्राचीन ग्रंथ है जिसमें अतीत, वर्तमान और भविष्य से संबंधित कथाएँ, राजा-वंश, धर्मशास्त्र, नीति, चिकित्सा, योग, और विभिन्न युगों की भविष्यवाणियाँ समाहित हैं। यह पुराण वेदों, उपनिषदों और धर्मशास्त्रों के आधार पर सामाजिक और धार्मिक नियमों का भी विवेचन करता है। इसके कथानक ऐतिहासिक, आध्यात्मिक और सांस्कृतिक दृष्टि से अत्यंत समृद्ध हैं। यह गीता प्रेस गोरखपुर का संस्करण है, जो विश्वसनीय और पारंपरिक पाठ प्रस्तुत करता है।",
                 images: ["https://sarvwigyan.github.io/resources/BhavishyaPuran.png"],file: "Books/BhavishyaPuranHindi.html",language: "Hindi"},
                { id: 12, title: "Statistics 101", type: "Books", verified: false, logo: "https://via.placeholder.com/64", shortDesc: "Understand stats.", longDesc: "A basic introduction to statistical methods and analysis.", images: ["https://via.placeholder.com/200x120"], file: "stats.pdf", language: "English" },
            ],
            chelp: [
                { id: 3, title: "HelpHub", type: "Tools", verified: true, logo: "https://via.placeholder.com/64", shortDesc: "Quick assistance guide.", longDesc: "Your go-to guide for quick assistance and support.", images: ["https://via.placeholder.com/200x120"], file: "helphub.apk" },
                { id: 4, title: "TechAid", type: "Tools", verified: false, logo: "https://via.placeholder.com/64", shortDesc: "Solve tech issues.", longDesc: "Solve tech issues with this handy support app.", images: ["https://via.placeholder.com/200x120"], file: "techaid.apk" },
                { id: 13, title: "CodeMaster", type: "Tools", verified: true, logo: "https://via.placeholder.com/64", shortDesc: "Coding assistant.", longDesc: "Boost your coding skills with this tool.", images: ["https://via.placeholder.com/200x120"], file: "codemaster.apk" },
                { id: 14, title: "DebugPro", type: "Tools", verified: false, logo: "https://via.placeholder.com/64", shortDesc: "Debug easily.", longDesc: "A tool to help you debug code efficiently.", images: ["https://via.placeholder.com/200x120"], file: "debugpro.apk" },
                { id: 15, title: "ScriptGenix", type: "Tools", verified: true, logo: "https://via.placeholder.com/64", shortDesc: "Generate scripts.", longDesc: "Automate script creation with this utility.", images: ["https://via.placeholder.com/200x120"], file: "scriptgenix.apk" },
                { id: 16, title: "API Helper", type: "Tools", verified: false, logo: "https://via.placeholder.com/64", shortDesc: "API testing tool.", longDesc: "Test and explore APIs with ease.", images: ["https://via.placeholder.com/200x120"], file: "apihelper.apk" },
            ],
            games: [
                { id: 5, title: "Puzzle Master", type: "Games", verified: true, logo: "https://via.placeholder.com/64", shortDesc: "Challenging puzzles.", longDesc: "Test your brain with these challenging puzzles.", images: ["https://via.placeholder.com/200x120"], file: "puzzle.apk" },
                { id: 6, title: "Adventure Quest", type: "Games", verified: false, logo: "https://via.placeholder.com/64", shortDesc: "Epic adventures await.", longDesc: "Embark on epic adventures in this RPG game.", images: ["https://via.placeholder.com/200x120"], file: "adventure.apk" },
                { id: 17, title: "Space Shooter", type: "Games", verified: true, logo: "https://via.placeholder.com/64", shortDesc: "Shoot aliens!", longDesc: "Defend the galaxy in this action-packed shooter.", images: ["https://via.placeholder.com/200x120"], file: "spaceshooter.apk" },
                { id: 18, title: "Racing Rush", type: "Games", verified: false, logo: "https://via.placeholder.com/64", shortDesc: "Race to win.", longDesc: "Speed through tracks in this racing game.", images: ["https://via.placeholder.com/200x120"], file: "racingrush.apk" },
                { id: 19, title: "Trivia King", type: "Games", verified: true, logo: "https://via.placeholder.com/64", shortDesc: "Test your knowledge.", longDesc: "Challenge yourself with trivia questions.", images: ["https://via.placeholder.com/200x120"], file: "triviaking.apk" },
                { id: 20, title: "Platform Jumper", type: "Games", verified: false, logo: "https://via.placeholder.com/64", shortDesc: "Jump to survive.", longDesc: "Navigate platforms in this fun game.", images: ["https://via.placeholder.com/200x120"], file: "platformjumper.apk" },
            ],
            productivity: [
                { id: 7, title: "Task Manager", type: "Productivity", verified: true, logo: "https://via.placeholder.com/64", shortDesc: "Organize your tasks.", longDesc: "Stay organized with this powerful task manager.", images: ["https://via.placeholder.com/200x120"], file: "taskmanager.apk" },
                { id: 8, title: "Note Taker", type: "Productivity", verified: false, logo: "https://via.placeholder.com/64", shortDesc: "Take notes easily.", longDesc: "Capture your thoughts with this simple note-taking app.", images: ["https://via.placeholder.com/200x120"], file: "notetaker.apk" },
                { id: 21, title: "Time Tracker", type: "Productivity", verified: true, logo: "https://via.placeholder.com/64", shortDesc: "Track your time.", longDesc: "Monitor your productivity with this tool.", images: ["https://via.placeholder.com/200x120"], file: "timetracker.apk" },
                { id: 22, title: "Goal Setter", type: "Productivity", verified: false, logo: "https://via.placeholder.com/64", shortDesc: "Set your goals.", longDesc: "Plan and achieve your objectives.", images: ["https://via.placeholder.com/200x120"], file: "goalsetter.apk" },
                { id: 23, title: "Calendar Pro", type: "Productivity", verified: true, logo: "https://via.placeholder.com/64", shortDesc: "Manage events.", longDesc: "Keep your schedule in check.", images: ["https://via.placeholder.com/200x120"], file: "calendarpro.apk" },
                { id: 24, title: "Focus Timer", type: "Productivity", verified: false, logo: "https://via.placeholder.com/64", shortDesc: "Boost focus.", longDesc: "Use Pomodoro technique to stay focused.", images: ["https://via.placeholder.com/200x120"], file: "focustimer.apk" },
            ]
        };

        const featured = [
            storeData.books[0],
            storeData.chelp[0],
            storeData.games[0],
            storeData.productivity[0],
            storeData.books[2],
            storeData.chelp[2]
        ];

        function readBook(item) {
            if (!item.file || item.file === '') {
                alert('Sorry, the book is not available for reading at this time.');
                return;
            }
            try {
                window.open(item.file, '_blank');
            } catch (e) {
                alert('Unable to open the book. Please check if it is supported by your browser.');
            }
        }

        function downloadAndOpenFile(item) {
            const filePath = item.file;
            if (!filePath || filePath === '') {
                alert('Sorry, the file is not available for download at this time.');
                return;
            }
            const fileName = filePath.split('/').pop();
            const link = document.createElement('a');
            link.href = filePath;
            link.download = fileName;
            document.body.appendChild(link);
            try {
                link.click();
                document.body.removeChild(link);
                setTimeout(() => {
                    const shouldOpen = confirm(`"${fileName}" has been downloaded. Would you like to open it now?`);
                    if (shouldOpen) {
                        try {
                            window.open(filePath, '_blank');
                        } catch (e) {
                            alert('Unable to open the file. Please check if it is supported by your browser.');
                        }
                    }
                }, 1000);
            } catch (e) {
                document.body.removeChild(link);
                alert('Download failed. Please try again later.');
            }
        }

        function renderCards(data, containerId) {
            const container = document.getElementById(containerId);
            if (!container) {
                console.error(`Container not found: ${containerId}`);
                return;
            }
            container.innerHTML = '';

            const noResultsId = containerId.replace('Grid', 'NoResults');
            const noResultsElement = document.getElementById(noResultsId);

            if (!data || data.length === 0) {
                if (noResultsElement) {
                    noResultsElement.style.display = 'block';
                }
                return;
            }

            if (noResultsElement) {
                noResultsElement.style.display = 'none';
            }

            data.forEach(item => {
                const card = document.createElement('div');
                card.className = 'card';
                card.setAttribute('role', 'button');
                card.setAttribute('tabindex', '0');
                card.setAttribute('aria-label', `View details for ${item.title}`);
                const buttonText = item.type === 'Books' ? 'Read' : 'Download';
                card.innerHTML = `
                    <img class="card-logo" src="${item.logo}" alt="${item.title}">
                    <div class="card-title">${item.title}</div>
                    <div class="card-type">${item.type}</div>
                    <button class="card-download" aria-label="${buttonText} ${item.title}">${buttonText}</button>
                `;
                card.addEventListener('click', (e) => {
                    if (e.target.className !== 'card-download') showDetail(item);
                });
                card.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        showDetail(item);
                    }
                });
                card.querySelector('.card-download').addEventListener('click', () => {
                    if (item.type === 'Books') {
                        readBook(item);
                    } else {
                        downloadAndOpenFile(item);
                    }
                });
                container.appendChild(card);
            });
        }

        renderCards(featured, 'featuredGrid');
        renderCards([...storeData.books, ...storeData.chelp, ...storeData.games, ...storeData.productivity], 'allGrid');
        renderCards(storeData.books, 'booksGrid');
        renderCards(storeData.chelp, 'chelpGrid');
        renderCards(storeData.games, 'gamesGrid');
        renderCards(storeData.productivity, 'productivityGrid');

        const tabs = document.querySelectorAll('.tab');
        const sections = document.querySelectorAll('.section');
        const featuredSection = document.querySelector('.featured-section');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => switchTab(tab));
            tab.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    switchTab(tab);
                }
            });
        });

        function switchTab(tab) {
            tabs.forEach(t => {
                t.classList.remove('active');
                t.setAttribute('aria-selected', 'false');
            });
            tab.classList.add('active');
            tab.setAttribute('aria-selected', 'true');
            sections.forEach(s => s.classList.remove('active'));
            const tabId = tab.getAttribute('data-tab');
            document.getElementById(tabId).classList.add('active');
            document.getElementById('detailView').classList.remove('active');
            document.body.style.overflowY = 'auto';
            featuredSection.style.display = tabId === 'all' ? 'block' : 'none';
            if (tabId === 'recent') {
                renderRecentlyViewed();
            } else if (tabId === 'favorites') {
                renderFavorites();
            } else {
                performSearch();
            }
            document.getElementById('language-filter').style.display = 'none'; // Reset language filter visibility
        }

        const searchInput = document.getElementById('searchInput');
        function debounce(func, delay) {
            let timeout;
            return function(...args) {
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(this, args), delay);
            };
        }

        searchInput.addEventListener('input', debounce(performSearch, 300));

        function performSearch() {
            const query = searchInput.value.toLowerCase();
            const activeTab = document.querySelector('.tab.active').getAttribute('data-tab');
            if (activeTab === 'recent') {
                renderRecentlyViewed(query);
            } else if (activeTab === 'favorites') {
                renderFavorites(query);
            } else if (activeTab === 'all') {
                const allItems = [...storeData.books, ...storeData.chelp, ...storeData.games, ...storeData.productivity];
                const data = allItems.filter(item => item.title.toLowerCase().includes(query));
                renderCards(data, 'allGrid');
            } else {
                const data = storeData[activeTab].filter(item => item.title.toLowerCase().includes(query));
                renderCards(data, `${activeTab}Grid`);
            }
        }

        function showDetail(item) {
            const detailView = document.getElementById('detailView');
            const overlay = document.getElementById('overlay');
            document.getElementById('detailLogo').src = item.logo;
            document.getElementById('detailTitle').textContent = item.title;
            document.getElementById('detailType').textContent = item.type;
            document.getElementById('detailVerified').textContent = item.verified ? 'Verified' : '';
            document.getElementById('detailShortDesc').textContent = item.shortDesc;
            document.getElementById('detailLongDesc').textContent = item.longDesc;

            const imagesContainer = document.getElementById('detailImages');
            imagesContainer.innerHTML = '';
            item.images.forEach(imgSrc => {
                const img = document.createElement('img');
                img.src = imgSrc;
                img.alt = `${item.title} screenshot`;
                imagesContainer.appendChild(img);
            });

            const detailDownload = document.getElementById('detailDownload');
            detailDownload.textContent = item.type === 'Books' ? 'Read' : 'Download';
            detailDownload.setAttribute('aria-label', `${item.type === 'Books' ? 'Read' : 'Download'} ${item.title}`);
            detailDownload.onclick = () => {
                if (item.type === 'Books') {
                    readBook(item);
                } else {
                    downloadAndOpenFile(item);
                }
            };

            detailView.classList.add('active');
            overlay.classList.add('active');
            document.body.style.overflowY = 'hidden';
            document.getElementById('closeBtn').focus();

            let recentlyViewed = JSON.parse(localStorage.getItem('recentlyViewed')) || [];
            recentlyViewed = recentlyViewed.filter(id => id !== item.id);
            recentlyViewed.unshift(item.id);
            if (recentlyViewed.length > 5) recentlyViewed.pop();
            localStorage.setItem('recentlyViewed', JSON.stringify(recentlyViewed));
        }

        function renderRecentlyViewed(query = '') {
            const recentlyViewed = JSON.parse(localStorage.getItem('recentlyViewed')) || [];
            let items = [];
            recentlyViewed.forEach(id => {
                for (let category in storeData) {
                    const item = storeData[category].find(item => item.id === id);
                    if (item && (!query || item.title.toLowerCase().includes(query.toLowerCase()))) {
                        items.push(item);
                    }
                }
            });
            renderCards(items, 'recentGrid');
        }

        function renderFavorites(query = '') {
            const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            let items = [];
            favorites.forEach(id => {
                for (let category in storeData) {
                    const item = storeData[category].find(item => item.id === id);
                    if (item && (!query || item.title.toLowerCase().includes(query.toLowerCase()))) {
                        items.push(item);
                    }
                }
            });
            renderCards(items, 'favoritesGrid');
        }

        function toggleFavorite(itemId) {
            let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            if (favorites.includes(itemId)) {
                favorites = favorites.filter(id => id !== itemId);
            } else {
                favorites.push(itemId);
            }
            localStorage.setItem('favorites', JSON.stringify(favorites));
            if (document.querySelector('.tab.active').getAttribute('data-tab') === 'favorites') {
                renderFavorites(searchInput.value);
            }
        }

        document.getElementById('closeBtn').addEventListener('click', closeModal);
        document.getElementById('detailView').addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });

        function closeModal() {
            const detailView = document.getElementById('detailView');
            const overlay = document.getElementById('overlay');
            detailView.classList.remove('active');
            overlay.classList.remove('active');
            document.body.style.overflowY = 'auto';
            const activeTab = document.querySelector('.tab.active').getAttribute('data-tab');
            if (activeTab === 'recent') {
                renderRecentlyViewed();
            } else if (activeTab === 'favorites') {
                renderFavorites();
            } else {
                performSearch();
            }
            featuredSection.style.display = activeTab === 'all' ? 'block' : 'none';
        }

        const settingsIcon = document.getElementById('settingsIcon');
        const settingsWindow = document.getElementById('settingsWindow');
        const overlay = document.getElementById('overlay');
        const themeSelect = document.getElementById('theme');
        const enableFavorites = document.getElementById('enableFavorites');

        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.body.dataset.theme = savedTheme;
        themeSelect.value = savedTheme;

        const favoritesEnabled = localStorage.getItem('favoritesEnabled') === 'true';
        enableFavorites.checked = favoritesEnabled;
        document.querySelector('.tab[data-tab="favorites"]').classList.toggle('hidden', !favoritesEnabled);

        settingsIcon.addEventListener('click', () => {
            settingsWindow.classList.add('active');
            overlay.classList.add('active');
            settingsWindow.querySelector('#theme').focus();
        });

        overlay.addEventListener('click', () => {
            settingsWindow.classList.remove('active');
            document.getElementById('detailView').classList.remove('active');
            overlay.classList.remove('active');
            document.body.style.overflowY = 'auto';
            const activeTab = document.querySelector('.tab.active').getAttribute('data-tab');
            featuredSection.style.display = activeTab === 'all' ? 'block' : 'none';
        });

        document.getElementById('saveSettings').addEventListener('click', () => {
            const theme = themeSelect.value;
            document.body.dataset.theme = theme;
            localStorage.setItem('theme', theme);

            const showFavorites = enableFavorites.checked;
            localStorage.setItem('favoritesEnabled', showFavorites);
            document.querySelector('.tab[data-tab="favorites"]').classList.toggle('hidden', !showFavorites);

            settingsWindow.classList.remove('active');
            overlay.classList.remove('active');
            const activeTab = document.querySelector('.tab.active').getAttribute('data-tab');
            featuredSection.style.display = activeTab === 'all' ? 'block' : 'none';
        });

        const headerLogo = document.querySelector('.header-logo');
        headerLogo.addEventListener('dblclick', () => {
            headerLogo.classList.toggle('rainbow-active');
        });

        document.querySelector('.tab-list').addEventListener('keydown', (e) => {
            const activeTab = document.querySelector('.tab.active');
            const tabList = Array.from(tabs);
            const index = tabList.indexOf(activeTab);
            if (e.key === 'ArrowRight') {
                e.preventDefault();
                const nextTab = tabList[(index + 1) % tabList.length];
                if (!nextTab.classList.contains('hidden')) {
                    switchTab(nextTab);
                    nextTab.focus();
                }
            } else if (e.key === 'ArrowLeft') {
                e.preventDefault();
                const prevTab = tabList[(index - 1 + tabList.length) % tabList.length];
                if (!prevTab.classList.contains('hidden')) {
                    switchTab(prevTab);
                    prevTab.focus();
                }
            }
        });

        function filterApps(containerId, filterType) {
            if (containerId === 'booksGrid' && filterType === 'language') {
                document.getElementById('language-filter').style.display = 'inline';
            } else {
                document.getElementById('language-filter').style.display = 'none';
            }
            logActivity('Filter Applied', { containerId, filterType });
            // Placeholder for actual filtering logic
            // You can implement specific filtering logic here based on filterType
        }

        function filterByLanguage(language) {
            const query = searchInput.value.toLowerCase();
            const data = storeData.books.filter(item => 
                item.language.toLowerCase() === language.toLowerCase() && 
                (!query || item.title.toLowerCase().includes(query))
            );
            renderCards(data, 'booksGrid');
            logActivity('Language Filter Applied', { language });
        }

        function logActivity(action, details) {
            console.log(`[${new Date().toISOString()}] ${action}: ${JSON.stringify(details)}`);
        }

        function validateItem(item) {
            return item && item.id && item.title && item.type && item.logo && item.shortDesc && item.longDesc && item.file;
        }

        function getCategoryById(id) {
            for (let category in storeData) {
                if (storeData[category].some(item => item.id === id)) {
                    return category;
                }
            }
            return null;
        }

        function updateCardStyles() {
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                card.style.transition = `transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease`;
            });
        }

        function simulateContentLoad(containerId, delay) {
            setTimeout(() => {
                const container = document.getElementById(containerId);
                if (container) {
                    container.style.opacity = '1';
                }
            }, delay);
        }

        document.addEventListener('DOMContentLoaded', () => {
            logActivity('Page Loaded', { theme: savedTheme });
            updateCardStyles();
            simulateContentLoad('featuredGrid', 200);
            simulateContentLoad('allGrid', 200);
            simulateContentLoad('booksGrid', 300);
            simulateContentLoad('chelpGrid', 300);
            simulateContentLoad('gamesGrid', 300);
            simulateContentLoad('productivityGrid', 300);
            featuredSection.style.display = document.querySelector('.tab.active').getAttribute('data-tab') === 'all' ? 'block' : 'none';
        });
    </script>
</body>
</html>